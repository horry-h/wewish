# 当下的冲动 - 新分类功能说明

## 功能概述
新增"当下的冲动"分类，排列在分类列表的**第一位**，专门用于帮助用户解读内心直觉和瞬间冲动的意义。

---

## 1. 配置更新

### 分类数据 (index.ts)
```typescript
categories: [
  { 
    key: 'impulse', 
    name: '当下的冲动', 
    icon: '☄️', 
    color: '#FFDAB9',  // 温暖的桃色，代表瞬间的火花
    placeholder: '此时此刻，你的直觉想带你去哪？' 
  },
  { key: 'emotion', name: '关于感情', icon: '🍂' },
  { key: 'career', name: '工作与事业', icon: '🛤️' },
  { key: 'study', name: '学业与考试', icon: '📖' },
  { key: 'wealth', name: '财富与好运', icon: '💰' },
  { key: 'health', name: '身体与能量', icon: '🌿' },
  { key: 'dream', name: '心中的梦想', icon: '🎈' },
  { key: 'general', name: '此时此刻', icon: '✨' }
]
```

### 关键属性
- **key**: `impulse` - 用于后端逻辑匹配
- **icon**: ☄️ - 流星图标，象征瞬间的冲动和火花
- **color**: `#FFDAB9` - 温暖的桃色调
- **placeholder**: 引导性文案

---

## 2. AI 增强指令

### 专属Prompt (index.ts)
```typescript
impulse: '请像一位鼓励冒险也守护安全的向导。侧重探讨"直觉的纯粹性"与"行动的意义"。不要给出复杂的说教，要通过隐喻来解析这股冲动是来自灵魂的渴望还是暂时的迷雾，鼓励用户在安全的前提下，勇敢地听从内心的声音。语气关键词：炽热、纯粹、守护。'
```

### 设计理念
1. **平衡性**：鼓励冒险 + 守护安全
2. **探讨重点**：直觉的纯粹性 vs 行动的意义
3. **表达方式**：隐喻解析，非说教
4. **核心问题**：这股冲动来自灵魂渴望还是暂时迷雾？
5. **语气特点**：炽热、纯粹、守护

### 分类名称映射
```typescript
categoryNames: {
  impulse: '当下的冲动',
  // ... 其他分类
}
```

---

## 3. 页面布局适配

### WXSS优化 (index.less)
```less
.category-list-compact {
  display: flex;
  justify-content: center;
  flex-wrap: wrap;  // 支持自动换行
  gap: 12rpx;
  row-gap: 12rpx;
  max-width: 100%;  // 防止溢出
}

.category-chip {
  padding: 14rpx 22rpx;  // 调整：24->22rpx，适应8个分类
  // ... 其他样式
  flex-shrink: 0;  // 防止被压缩
}
```

### 布局说明
- **总数**：8个分类（原7个 + 新增1个）
- **排列方式**：Flex布局，自动换行
- **响应式**：不同屏幕自动调整为2-3行
- **间距**：12rpx，保持呼吸感
- **对齐**：居中对齐

---

## 4. 逻辑关联

### 海报生成修复
```typescript
// 修复索引：新增分类后，'此时此刻'从索引6变为7
const category = this.data.categories.find(
  cat => cat.key === (this.data.selectedCategory || 'general')
) || this.data.categories[7]  // 更新：6->7
```

### 答案筛选
- 当用户选择"当下的冲动"时，系统会：
  1. 从答案库中筛选带有 `impulse` 标签的答案
  2. 使用专属的AI增强指令进行解读
  3. 采用"炽热、纯粹、守护"的语气风格

### 默认提示语（待实现建议）
```typescript
// 建议在长按逻辑中增加判断
if (selectedCategory === 'impulse' && !userThought) {
  wx.showToast({
    title: '书灵正感应你此刻的直觉...',
    icon: 'none'
  })
}
```

---

## 5. 用户体验设计

### 使用场景
1. **瞬间念头**：突然想做某件事
2. **直觉反应**：莫名的预感或感觉
3. **冲动决定**：想立即行动的想法
4. **内心呼唤**：无法解释的渴望

### 交互流程
```
用户选择"当下的冲动" 
  → 输入心中冲动（可选）
  → 长按"闭目默念"
  → 抽取答案
  → 书灵用"守护式冒险"的语气解读
  → 帮助用户分辨冲动的本质
```

### 预期效果
- ✅ 鼓励用户倾听内心声音
- ✅ 帮助分析冲动的来源
- ✅ 在安全前提下支持行动
- ✅ 提供诗意化的决策参考

---

## 6. 技术要点

### 文件修改清单
1. **index.ts**
   - 新增分类对象（第一位）
   - 添加AI增强指令
   - 更新分类名称映射
   - 修复海报生成索引

2. **index.less**
   - 优化分类布局
   - 调整间距和padding
   - 确保8个分类适配

3. **index.wxml**
   - 无需修改（自动遍历categories数组）

### 兼容性
- ✅ 自动适配现有UI组件
- ✅ 支持所有屏幕尺寸
- ✅ 保持原有交互逻辑
- ✅ AI系统自动识别新分类

---

## 7. 测试建议

### 功能测试
- [ ] 分类显示在第一位
- [ ] 点击选中样式正确
- [ ] 抽签功能正常
- [ ] AI解读语气符合设定
- [ ] 海报生成显示正确分类

### 视觉测试
- [ ] 8个分类排列整齐
- [ ] 不同屏幕换行正确
- [ ] 图标☄️显示正常
- [ ] 选中态高亮效果

### 内容测试
- [ ] 测试不同场景的冲动描述
- [ ] 验证AI回复的"炽热、纯粹、守护"风格
- [ ] 检查隐喻性表达是否恰当

---

## 8. 扩展建议

### 答案库增强
建议在 `answers.json` 中为 `impulse` 标签准备专属答案：
```json
{
  "text": "听从心的声音",
  "category": "impulse",
  "weight": 1.0
}
```

### 特殊交互（可选）
```typescript
// 选择"当下的冲动"时，可以触发特殊动画
if (category === 'impulse') {
  // 流星划过效果
  this.playMeteorAnimation()
}
```

---

## 更新日期
2026-01-29

## 开发者
AI Assistant

## 版本
v1.0 - 初始实现
